{% extends "base.html" %}
{% load static %}

{% block title %}Update Plant{% endblock %}

{% block content %}
<div class="update_plant_container">
  <h1 class="update_plant_title">Update Plant: {{ plant.name }}</h1>

  <form method="post" enctype="multipart/form-data" class="update_plant_form">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="form_group">
      {{ form.name.label_tag }}
      {{ form.name }}
      {{ form.name.errors }}
    </div>

    <div class="form_group">
      {{ form.category.label_tag }}
      {{ form.category }}
      {{ form.category.errors }}
    </div>

    <div class="form_group">
      {{ form.about.label_tag }}
      {{ form.about }}
      {{ form.about.errors }}
    </div>

    <div class="form_group">
      {{ form.used_for.label_tag }}
      {{ form.used_for }}
      {{ form.used_for.errors }}
    </div>

    <div class="form_group">
      {{ form.native_to.label_tag }}
      {{ form.native_to }}
      {{ form.native_to.errors }}
    </div>

    <div class="form_group">
      {{ form.image.label_tag }}
      <!-- Display the existing image if available -->
      <div class="current_image">
        {% if plant.image %}
        <img src="{{ plant.image.url }}" alt="{{ plant.name }}" class="plant_image_preview" />
        {% else %}
        <p>No image available.</p>
        {% endif %}
      </div>
      {{ form.image }}
      {{ form.image.errors }}
    </div>

    <div class="form_group">
      {{ form.is_edible.label_tag }}
      {{ form.is_edible }}
      {{ form.is_edible.errors }}
    </div>

    <button type="submit" class="update_submit_button">Save Changes</button>
  </form>

  <!-- Delete form with a confirmation dialog -->
  <form method="POST" action="{% url 'plants:delete_plant' plant.id %}" class="delete_plant_form"
    onsubmit="return confirm('Are you sure you want to delete this plant?');">
    {% csrf_token %}
    <button type="submit" class="delete_button">Delete Plant</button>
  </form>

  <div class="back_button_container">
    <a href="{% url 'plants:plants_view' %}" class="back_button">Back to All Plants</a>
  </div>
</div>
{% endblock %}